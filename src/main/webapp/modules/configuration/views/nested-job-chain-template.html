<div class="row">
    <div class="col-md-12">
        <div class="box p-a">
            <div ng-class="pageView=='form' ? 'b-b p-b m-b' : ''">
                <span class="text text-primary"><span ng-if="jobChain.path">{{jobChain.path}}<span
                        ng-if="jobChain.path !=='/'">/</span>{{jobChain.name}} - </span></span>
                <span class="text text-dark" translate>joe.label.nestedJobChain</span>
            </div>
            <div>
                <div class="form-group row">
                    <div class="p-a-sm m-l-xs m-r-xs p-t-0">
                        <div class="p-t-md">
                            <form name="myForm" role="form">
                                <div class="form-group row"
                                     ng-class="{ 'has-error' : myForm.state.$invalid && myForm.state.$dirty }">
                                    <label class="col-md-4 col-lg-3 form-control-label"
                                           translate>joe.label.state</label>
                                    <div class="col-md-8 col-lg-6">
                                        <input type="text" required ng-maxlength="255" class="form-control"
                                               autofocus name="state" ng-model="node.state">
                                        <div class="text-danger help-block" ng-if="myForm.state.$dirty"
                                             ng-messages="myForm.state.$error">
                                            <div ng-message="required" translate>message.requiredError</div>
                                            <div ng-message="maxlength" translate>message.tooLongError</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row" ng-if="node.nodeType==='Full Node'">
                                    <label class="col-md-4 col-lg-3 form-control-label" translate>label.jobChain</label>
                                    <div class="col-md-8 col-lg-6">
                                        <div class="row">
                                            <div class="col-md-12 col-lg-12">
                                                <select class="form-control" name="nextState"
                                                        ng-required="node.nodeType==='Full Node'"
                                                        ng-model="node.jobChain" style="border: none">
                                                    <option value="{{jobChain.name}}" ng-repeat="jobChain in jobChains">{{jobChain.name}}
                                                    </option>
                                                </select>
                                                <div class="input-dropdown" style="margin-bottom: -27px;top: -28px">
                                                    <input type="text" class="form-control"
                                                           placeholder="{{'placeholder.enterJobPath' | translate}}"
                                                           name="StepNodesJob" ng-model="node.jobChain">
                                                </div>
                                                <i class="fa fa-folder-o inside-textBox" style="right: -20px;"
                                                   ng-click="getJobChainTreeStructure()" aria-hidden="true"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row" ng-if="node.nodeType==='Full Node'">
                                    <label class="col-md-4 col-lg-3 form-control-label"
                                           translate>joe.label.nextState</label>
                                    <div class="col-md-8 col-lg-6">
                                        <select class="form-control" name="nextState"
                                                ng-required="node.nodeType==='Full Node'"
                                                ng-model="node.nextState" style="border: none"
                                                ng-options="next for next in _nextState">
                                        </select>
                                        <div class="input-dropdown" style="margin-bottom: -27px;top: -28px">
                                            <input name="nextState" class="form-control" ng-model="node.nextState"
                                                   type="text">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row" ng-if="node.nodeType==='Full Node'">
                                    <label class="col-md-4 col-lg-3 form-control-label"
                                           translate>joe.label.errorState</label>
                                    <div class="col-md-8 col-lg-6">
                                        <select class="form-control" name="errorState"
                                                ng-required="node.nodeType==='Full Node'"
                                                ng-model="node.errorState" style="border: none"
                                                ng-options="err for err in _errorState">
                                            <option value="?" selected="selected"></option>
                                        </select>
                                        <div class="input-dropdown" style="margin-bottom: -27px;top: -28px">
                                            <input name="errorState" class="form-control" ng-model="node.errorState"
                                                   type="text">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label class="col-md-4 col-lg-3 form-control-label" translate></label>
                                    <div class="col-md-8 col-lg-6">
                                        <label class="md-check w">
                                            <input type="radio" name="stepNodesNodeType"
                                                   ng-model="node.nodeType" value="Full Node"
                                                   class="ng-pristine ng-untouched ng-valid ng-not-empty">
                                            <i class="primary"></i> <span translate>joe.label.fullNode</span>
                                        </label>
                                        <label class="md-check w">
                                            <input type="radio" name="stepNodesNodeType"
                                                   ng-model="node.nodeType" value="End Node"
                                                   class="ng-pristine ng-untouched ng-valid ng-not-empty">
                                            <i class="primary"></i> <span translate>joe.label.endNode</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-md-12">
                                        <button type="button" class="btn btn-sm btn-primary"
                                                ng-disabled="myForm.$invalid" ng-click="applyNode(myForm)">
                                            <span translate>button.done</span>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-grey m-l-sm" ng-if="_tempNode"
                                                ng-click="cancelNode(myForm)">
                                            <span translate>button.cancel</span>
                                        </button>
                                    </div>
                                </div>
                            </form>
                            <hr>
                            <div class="p-t-sm">
                                <table class="table table-hover table-bordered ">
                                    <thead>
                                    <tr>
                                        <th class="menu"><span translate>label.action</span></th>
                                        <th><span translate>joe.label.state</span></th>
                                        <th><span translate>label.node</span></th>
                                        <th><span translate>label.jobChain</span></th>
                                        <th><span translate>joe.label.nextState</span></th>
                                        <th><span translate>joe.label.errorState</span></th>
                                    </tr>
                                    </thead>
                                    <tbody ui-sortable="sortableOptions" ng-model="jobChain.nestedJobChainNodes">
                                    <tr ng-repeat="jobChain in jobChain.nestedJobChainNodes">
                                        <td>
                                            <div class="btn-group dropdown">
                                                <button type="button" class="btn-drop more-option-h" dropdown data-toggle="dropdown">
                                                    <i class="fa fa-ellipsis-h"></i>
                                                </button>
                                                <div class="dropdown-menu list-dropdown dropdown-ac dropdown-more" role="menu">
                                                    <a ng-click="removeNode(jobChain);" class="dropdown-item"
                                                       translate>button.delete</a>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="cursor" ng-click="editNode(jobChain);">{{jobChain.state}}</td>
                                        <td class="cursor" ng-click="editNode(jobChain);" translate>label.jobChain</td>
                                        <td class="cursor" ng-click="editNode(jobChain);">{{jobChain.jobChain}}</td>
                                        <td class="cursor" ng-click="editNode(jobChain);">{{jobChain.nextState}}</td>
                                        <td class="cursor" ng-click="editNode(jobChain);">{{jobChain.errorState}}</td>
                                    </tr>
                                    </tbody>
                                    <tr ng-repeat="endNode in jobChain.jobChainEndNodes">
                                        <td>
                                            <div class="btn-group dropdown">
                                                <button type="button" class="btn-drop more-option-h" dropdown="" data-toggle="dropdown"><i class="fa fa-ellipsis-h"></i></button>
                                                <div class="dropdown-menu list-dropdown dropdown-ac dropdown-more" role="menu">
                                                    <a ng-click="removeEndNode(endNode);" class="dropdown-item" translate>button.delete</a>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="cursor" ng-click="editEndNode(endNode);" translate>{{endNode.state}}</td>
                                        <td class="cursor" ng-click="editEndNode(endNode);" translate>joe.label.endNode</td>
                                        <td class="cursor" ng-click="editEndNode(endNode);"></td>
                                        <td class="cursor" ng-click="editEndNode(endNode);"></td>
                                        <td class="cursor" ng-click="editEndNode(endNode);"></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
