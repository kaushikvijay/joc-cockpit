<style>
    textarea {
        resize: none;
    }
</style>
<div class="modal fade" id="expression-editor" tabindex="-1" role="dialog" aria-labelledby="user" data-backdrop="static" style="background: rgba(0,0,0,.1)">
    <div class="modal-dialog box-shadow modal-lg" style="margin-top: 12px">
        <div class="modal-content" style="box-shadow: 0 0 8px rgba(0,0,0,0.18); margin-left: 20px; margin-right: 20px">
            <div class="modal-body p-a p-l-md p-r-md">
                <form name="form3" ng-submit="save3(form3)" novalidate>
                    <div>
                        <div class="row m-b-sm">
                            <label class="col-sm-12">
                                 <span class="text-md _600" translate>label.expressionEditor</span>
                            </label>
                            <a ng-click="close3(form3)" style="float: right; position: absolute; right: -8px; top: -17px; font-size: 27px; opacity: .5"><i class="fa fa-times-circle"></i></a>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12">
                                <textarea rows="3" class="form-control" ng-model="expression.expression" placeholder="returncode:x, event:event, fileexist:filename" autofocus
                                          ng-change="validateExpression()" ng-keypress="onKepPress($event)"  name="expression"></textarea>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12">
                                <div class="text-center">
                                    <div>
                                        <button type="button" ng-click="generateExpression('and', null)"
                                                class="btn btn-sm btn-grey m-l-xs"> AND
                                        </button>
                                        <button type="button" ng-click="generateExpression('or', null)"
                                                class="btn btn-sm btn-grey m-l-xs"> OR
                                        </button>
                                        <button type="button" ng-click="generateExpression('not', null)"
                                                class="btn btn-sm btn-grey m-l-xs"> NOT
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-6" >
                                <div><span translate>label.functions</span>:</div>
                                <div class="b-a p-a" style="height: 204px; overflow: auto">
                                    <div>
                                        <a class="text-hover-primary text" ng-click="generateExpression(null,'returncode')">returncode</a>
                                    </div>
                                    <div class="m-t-xs">
                                        <i ng-if="expression.open" ng-click="expression.open = false" class="fa fa-angle-down m-r-sm"></i>
                                        <i ng-if="!expression.open" ng-click="expression.open = true" class="fa fa-angle-right m-r-sm"></i>
                                        <a class="text-hover-primary text" ng-click="generateExpression(null,'event')">event</a>
                                        <ul class="m-t-xs m-b-0" ng-if="expression.open">
                                            <li ng-repeat="func in functions">
                                              <a class="text-hover-primary"  ng-click="generateExpression('function', func)">{{func}}</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="m-t-xs">
                                        <a class="text-hover-primary text" ng-click="generateExpression(null,'fileexist')">fileexist</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6" >
                                <div><span translate>label.description</span>:</div>
                                <div class="b-a p-a" style="height: 204px;overflow: auto">
                                    <div ng-if="expression.type === 'returncode'">
                                        <label class="_600">returnCode</label>
                                        <p class="text-sm">
                                            Returncode of the last job run
                                        </p>
                                        <div class="text-sm p-a-sm syntax-box">
                                            <div translate>The returncode can be specified</div>
                                            <div class="m-t-sm" translate>label.example</div>
                                            <div class="text-muted">returncode:-2, returncode: 1-7</div>
                                        </div>
                                    </div>
                                    <div ng-if="expression.type === 'event'">
                                        <label class="_600">event</label>
                                        <p class="text-sm m-b-sm">
                                            The event is specified by event:name_of_event
                                        </p>
                                        <ul style="margin-left: -10px">
                                            <li>event: is optional</li>
                                            <li>name_of_event can also have the name of a workflow that created the event.</li>
                                        </ul>
                                        <div class="text-sm p-a-sm syntax-box">
                                            <div class="m-t-sm" translate>label.example</div>
                                            <div class="text-muted">{{_eventExample}}</div>
                                        </div>
                                    </div>
                                    <div ng-if="expression.type === 'fileexist'">
                                        <label class="_600">fileexist</label>
                                        <p class="text-sm">
                                            does a file exist?
                                        </p>
                                        <div class="text-sm p-a-sm syntax-box">
                                            <div class="m-t-sm" translate>label.example</div>
                                            <div class="text-muted"> (fileexist:test.txt)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="m-t">
                        <button type="submit" class="btn btn-primary btn-sm" ng-disabled="form3.$invalid">
                            <span translate>button.save</span>
                        </button>
                        <button type="button" class="btn btn-grey btn-sm m-l-sm" ng-click="close3(form3)" translate>
                            button.cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

