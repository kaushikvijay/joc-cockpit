<div class="modal-header">
  <h4 class="modal-title" translate>workflow.label.export</h4>
  <button type="button" class="close" (click)="cancel()" aria-label="Close">
      <span aria-hidden="true" class="fa fa-times-circle"></span>
  </button>
</div>
<form name="form" (ngSubmit)="export()" spellcheck="false">
  <div class="modal-body p-a">
    <div class="row m-b-sm">
      <div class="col-md-12">
        <a class="text" (click)="expandAll();" [nz-tooltip]="'tooltip.expandAll' | translate">
          <i class="fa fa-angle-double-down fa-lg"></i>
        </a>
        <a class="text m-l-xs" (click)="collapseAll();" [nz-tooltip]="'tooltip.collapseAll' | translate">
          <i class="fa fa-angle-double-up fa-lg"></i>
        </a>
        <span  class="pull-right">
          <span class="md-check w-auto m-r">
            <input type="checkbox" name="signed" [(ngModel)]="showSigned"/> <i class="primary"></i> <span class="text-success"
                translate>workflow.label.signed</span>
          </span>
          <span class="md-check w-auto">
            <input type="checkbox" name="unSigned" [(ngModel)]="showUnSigned"/> <i class="primary"></i> <span class="text-warning"
            translate>workflow.label.unSigned</span>
          </span>
        </span>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <nz-tree #treeCtrl nzNoAnimation
          [nzShowExpand]="false"
          [nzData]="deployables"
          [nzExpandAll]="isExpandAll"
          [nzTreeTemplate]="nzTreeTemplate"
        ></nz-tree>
        <ng-template #nzTreeTemplate let-node>
            <div class="node-wrapper" *ngIf="(!node.origin.type && !node.origin.order)|| node.origin.order || (node.origin.type && (node.origin.isSigned && showSigned) || (!node.origin.isSigned && showUnSigned))">
              <span *ngIf="node.children && node.children.length>0"
                    [class.toggle-children-wrapper-expanded]="node.isExpanded"
                    [class.toggle-children-wrapper-collapsed]="!node.isExpanded"
                    (click)="openFolder(node)" class="cursor w-14">
                    <span *ngIf="!node.isExpanded" class="fa fa-angle-right fa-lg p-r-10"></span>
                    <span *ngIf="node.isExpanded" class="fa fa-angle-down fa-lg p-r-10"></span>
                  </span>
              <span *ngIf="(!node.children || node.children.length === 0) && !node.origin.type" class="w-14">
                    <span class="fa fa-lg p-r-sm"></span>
                  </span>
              <label class="md-check w-18 m-r-xs"  *ngIf="!node.origin.object">
                <input type="checkbox" (click)="checkRecursiveOrder(node.origin)" name="'deploy' + {{node.key}}" [(ngModel)]="node.origin.recursivelyDeploy">
                <i class="primary"></i>
              </label>
              <div class="node-content-wrapper" [class.node-content-wrapper-active]="node.origin.isSelected" (click)="node.mouseAction('click', $event)">
                <i *ngIf="node.isExpanded && !node.origin.object && !node.origin.type" class="fa fa-folder-open-o w-14"></i>
                <i *ngIf="node.isCollapsed && !node.origin.object && !node.origin.type" class="fa fa-folder-o w-14"></i>
                <i *ngIf="node.origin.object == 'WORKFLOW'" nz-icon nzType="apartment" class="icon-color" nzTheme="outline"></i>
                <i *ngIf="node.origin.object == 'JOBCLASS'" nz-icon nzType="profile" class="icon-color" nzTheme="outline"></i>
                <i *ngIf="node.origin.object == 'JUNCTION'" nz-icon nzType="gateway" class="icon-color" nzTheme="outline"></i>
                <i *ngIf="node.origin.object == 'ORDER'" nz-icon nzType="unordered-list" class="icon-color" nzTheme="outline"></i>
                <i *ngIf="node.origin.object == 'LOCK'" nz-icon nzType="lock" class="icon-color" nzTheme="outline"></i>
                <i *ngIf="node.origin.object == 'AGENTCLUSTER'" nz-icon nzType="user" class="icon-color" nzTheme="outline"></i>
                <i *ngIf="node.origin.object == 'CALENDAR'" nz-icon nzType="calendar" class="icon-color" nzTheme="outline"></i>
                <span *ngIf="node.origin.type" [ngClass]="node.origin.isSigned ? ' text-success': ' text-warning'" class="fa fa-circle-o text-xs w-14" style="margin-top: 4px"></span>
                <span class="p-l-sm">{{node.origin.name || node.origin.path}}</span>
              </div>
            </div>
          </ng-template>

      </div>
    </div>
  </div>
  <div class="modal-footer text-left">
      <button type="submit" class="btn btn-primary btn-sm" translate>button.submit</button>
      <button type="button" class="btn btn-grey btn-sm" (click)="cancel()" translate>button.cancel</button>
  </div>
</form>
