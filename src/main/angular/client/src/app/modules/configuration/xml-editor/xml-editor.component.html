<div class="scroll-y">
  <div class="padding p-b-0" [hidden]="isLoading">

    <div class="row" [ngClass]="!submitXsd ? 'show': 'hide'">
      <div class="col-md-offset-4 col-md-4">
        <span class="form-group">
          <select class="form-control" [(ngModel)]="selectedXsd" name="schema" (change)="changeXSD(selectedXsd)">
            <option [value]="''"><---Choose one of the file---></option>
            <option [value]="'systemMonitorNotification'">System Monitor Notification</option>
            <option [value]="'yade'">YADE</option>
          </select>
        </span>
      </div>
      <div class="col-1">
        <span class="form-group">
          <a class="btn btn-primary btn-sm" (click)="submit()">Submit</a>
        </span>
      </div>
    </div>
    <div class="inline w-full" [ngClass]="submitXsd ? 'show': 'hide'">
      <div appResizable class="sticky leftPanel editor" id="leftSidePanel">
        <div class="editor-tree">
            <div class="row" *ngIf="nodes.length > 0">
              <div class="col-12">
                <a class="text" (click)="expandAll();" placement="bottom" ngbTooltip="{{'tooltip.expandAll' | translate}}">
                  <i class="fa fa-angle-double-down fa-lg"></i>
                </a>
                <a class="text m-l-xs" (click)="collapseAll();" placement="bottom" ngbTooltip="{{'tooltip.collapseAll' | translate}}">
                  <i class="fa fa-angle-double-up fa-lg"></i>
                </a>
              </div>
            </div>
            <div class="tree-block">
              <tree-root #treeCtrl [options]="options" (toggleExpanded)="toggleExpanded($event)"
                         [nodes]="nodes">
                <ng-template #treeNodeWrapperTemplate let-index="index" let-node>
                  <div class="node-wrapper">
                    <span *ngIf="node.hasChildren"
                          [class.toggle-children-wrapper-expanded]="node.isExpanded"
                          [class.toggle-children-wrapper-collapsed]="node.isCollapsed"
                          (click)="node.mouseAction('expanderClick', $event)" class="w-15 cursor">
                      <span *ngIf="node.isCollapsed" class="fa fa-angle-right fa-lg p-r-10"></span>
                      <span *ngIf="node.isExpanded" class="fa fa-angle-down fa-lg p-r-10"></span>
                    </span>
                    <span *ngIf="!node.hasChildren" class="fa fa-caret-right fa-lg w-15 m-t-xs"></span>
                    <div class="node-content-wrapper" [ngClass]="{'node-content-wrapper-active' :selectedNode && selectedNode.ref === node.data.ref && selectedNode.uuid === node.data.uuid}">
                      <span (click)="getData(node.data)"
                            [ngClass]="cutData && node.data.uuid === copyItem.uuid? 'disabled' : ''"
                            (mouseover)="tooltip(node.data)" data-toggle="tooltip" data-placement="top" [title]="tooltipAttrData? tooltipAttrData: ''">{{node.data.ref}}
                      </span>
                      <span class="text-sm pl-2" *ngIf="node.data.attributes && node.data.attributes.length>0 && node.data.attributes[0].data">
                        {{node.data.attributes[0].name}}={{node.data.attributes[0].data}}
                      </span>
                    </div>
                    <div appDropdown class="btn-group dropdown">
                      <button class="btn-drop more-option-h" data-toggle="dropdown" type="button" (mouseover)="checkChildNode(node.data);checkRules(node.data, copyItem);checkChoice(node.data)"><i
                        class="fa fa-ellipsis-h"></i></button>
                      <div class="dropdown-menu dropdown-ac dropdown-more list-dropdown" role="menu">
                        <a class="dropdown-item" id="addChild" [ngClass]="(node.parent == '#' || childNode.length>0) ? '':'disabled'">
                          <div translate>button.addChild</div>
                        </a>
                        <div *ngIf="childNode && childNode.length>0">
                          <a class="dropdown-item" [ngClass]="getCustomCss(child,node.data)" *ngFor="let child of childNode">
                            <div class="p-l-sm">
                              <a [ngClass]="checkmincss(child, node.data)" (click)="addChild(child, node.data)"><i class="fa fa-angle-right"></i>&nbsp;{{child.ref}}</a>
                            </div>
                          </a>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" (click)="showAllChildNode(node.data)">
                          <div translate>button.showAllChildNodes</div>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a (click)="expandNode(node.data)"
                           [ngClass]="node.data.children && node.data.children.length>0? '':'disabled'"
                           class="dropdown-item">
                          <div translate>button.expand</div>
                        </a>
                        <a (click)="collapseNode(node.data)"
                           [ngClass]="node.data.children && node.data.children.length>0? '':'disabled'"
                           class="dropdown-item">
                          <div translate>button.collapse</div>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a (click)="cutNode(node.data)" *ngIf="node.data && node.data.parent !=='#'"
                           [ngClass]="cutData? 'disabled' : ''" class="dropdown-item">
                          <div translate>button.cut</div>
                        </a>
                        <div *ngIf="node.data && node.data.parent !=='#'" class="dropdown-divider"></div>
                        <a (click)="copyNode(node.data)" class="dropdown-item">
                          <div translate>button.copy</div>
                        </a>
                        <a (click)="pasteNode(node.data)" [ngClass]="checkRule == true? '':'disabled'"
                           class="dropdown-item">
                          <div translate>button.paste</div>
                        </a>
                        <a (click)="removeNode(node.data, treeCtrl)"
                           [ngClass]="node.data && node.data.parent!=='#'? '':'disabled'"
                           class="dropdown-item">
                          <div translate>button.remove</div>
                        </a>
                      </div>
                    </div>
                  </div>
                </ng-template>
              </tree-root>
            </div>
          </div>
          <div class="rg-right"><span></span></div>
      </div>
      <div class="centerPanel" id="centerPanel">
        <div class="row pos-abt w-full m-t-n-20">
          <div class="col-md-12 m-b-sm">
            <div class="m-b-sm p-b-sm">
              <div class="inline w-full">
                  <button class="btn btn-sm btn-grey m-l-sm pull-right" placement="bottom" ngbTooltip="{{'button.export' | translate}}" (click)="save()">
                    <i class="fa fa-download"></i>
                  </button>
                  <button class="btn btn-sm btn-grey m-l-sm pull-right" placement="bottom" ngbTooltip="{{'button.validate' | translate}}" (click)="validate()">
                    <i class="fa fa-check"></i>
                  </button>
                  <button class="btn btn-sm btn-grey m-l-sm pull-right" (click)="showXml()" placement="bottom" ngbTooltip="{{'button.showXML' | translate}}">
                    <i class="fa fa-television"></i>
                  </button>
                  <button class="btn btn-sm btn-grey pull-right" (click)="importXML()" placement="bottom" ngbTooltip="{{'button.importXML' | translate}}">
                    <i class="fa fa-upload"></i>
                  </button>
                  <span class="badge float-right mr-2"  [ngClass]="validConfig?'badge-success':'badge-danger'">{{validConfig?'Validate':'Non-Validate'}}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="row" style="margin-top: -4px">
          <div *ngIf="selectedNode" class="col-12">
            <div *ngIf="selectedNode" class="text-md m-b _600 b-b p-b-sm">{{selectedNode.ref}}</div>
          </div>
          <div class="col-12">
            <div class="box p-a">
              <div *ngIf="selectedNode && selectedNode.text" class="text _600" translate>label.documentation</div>
              <span id="doc">
                <ul *ngIf="selectedNode && selectedNode.text && selectedNode.text.source" class="pl-5">
                  <li><a class="text-primary" href="{{selectedNode.text.source}}" target="_blank">{{selectedNode.text.source}}</a></li>
                </ul>
                <div *ngIf="selectedNode && selectedNode.text">
                  <div [innerHTML]="selectedNode.text.doc | safeHtml"></div>
                </div>
              </span>
            </div>
          </div>
          <div class="col-12" id="attr">
            <div class="box p-a">
              <div *ngIf="selectedNode">
                <div *ngIf="selectedNode.attributes && selectedNode.attributes.length>0 && selectedNode.attributes[0].id" class="_600 text m-b-sm">Attributes</div>
                <div *ngFor="let node of selectedNode.attributes" class="form-group">
                  <label *ngIf="node.name && node.id">{{node.name}}<sup
                    *ngIf="node.use==='required' || !node.use" class="text-danger text-sm">*</sup></label>
                  <span (click)="gotoKey(node)" *ngIf="node.refer" class="pull-right"><a>Goto Key Element</a></span>
                  <span (click)="gotoKeyref(node)" *ngIf="node.refElement"
                        class="pull-right"><a>Goto ref Element</a></span>
                  <span (mouseover)="getpos()" *ngIf="node.text" [ngClass]="(node.refer || node.refElement) ? 'pr-3': ''"
                        class="pull-right" data-toggle="tooltip" data-placement="left" title="{{node.text.doc}}">
                        <i class="fa fa-info-circle"></i>
                  </span>
                  <input #localref1 (blur)="validateAttr(localref1.value, node)"
                         (change)="submitData(localref1.value, node)"
                         *ngIf="node.values && node.values.length==0 && node.name && node.type === 'xs:string'"
                         [ngClass]="error && errorName === node.name? 'invalid': ''"
                         [required]="node.use ==='required'"
                         class="form-control" id="{{node.name}}" placeholder="Example input" type="text"
                         value="{{node.data? node.data:node.default}}">
                  <input #localref1 (blur)="validateAttr(localref1.value, node)"
                         (change)="submitData(localref1.value, node)"
                         *ngIf="node.values && node.values.length==0 && node.name && !node.type"
                         [ngClass]="error && errorName === node.name? 'invalid': ''"
                         [required]="node.use ==='required'" class="form-control"
                         id="{{node.name}}" placeholder="Example input" type="text"
                         value="{{node.data? node.data:node.default}}">
                  <input #localref2 (blur)="validateAttr(localref2.value, node)"
                         (change)="submitData(localref2.value, node)"
                         *ngIf="node.name && node.type === 'xs:NMTOKEN' && !node.refer"
                         [ngClass]="error && errorName === node.name? 'invalid': ''"
                         [required]="node.use ==='required'" class="form-control"
                         id="{{node.name}}" placeholder="Example input" title="{{node.name}} should not contain spaces"
                         type="text" value="{{node.data? node.data:node.default}}">
                  <select #localref6 (blur)="validateAttr(localref6.value, node)"
                          (change)="submitData(localref6.value, node)" (focus)="getDataAttr(node.refer)"
                          *ngIf="node.values && node.values.length==0 && node.name && node.type === 'xs:NMTOKEN' && node.refer"
                          [ngClass]="error && errorName === node.name? 'invalid': ''"
                          [ngModel]="node.data? node.data: node.default"
                          [required]="node.use ==='required'" class="form-control" id="{{node.name}}">
                    <option value=""></option>
                    <option *ngFor="let key of tempArr" value="{{key}}">{{key}}</option>
                  </select>
                  <input #localref3 (blur)="validateAttr(localref3.value, node)"
                         (change)="submitData(localref3.value, node)"
                         *ngIf="node.values && node.values.length==0 && node.name && node.type === 'xs:integer'"
                         [ngClass]="error && errorName === node.name? 'invalid': ''"
                         [required]="node.use ==='required'" class="form-control"
                         id="{{node.name}}" placeholder="Example input" required
                         type="number" value="{{node.data? node.data:node.default}}">
                  <input #localref4 (blur)="validateAttr(localref4.value, node)"
                         (change)="submitData(localref4.value, node)"
                         *ngIf="node.values && node.values.length==0 && node.name && node.type === 'xs:positiveInteger'"
                         [ngClass]="error && errorName === node.name? 'invalid': ''"
                         [required]="node.use ==='required'" class="form-control"
                         id="{{node.name}}" min="0" placeholder="Example input" type="number"
                         value="{{node.data?node.data:node.default}}">
                  <select #localref5 (blur)="validateAttr(localref5.value, node)"
                          (change)="submitData(localref5.value, node)"
                          *ngIf="node.values && node.values.length==0 && node.name && node.type === 'xs:boolean'"
                          [ngClass]="error && errorName === node.name? 'invalid': ''"
                          [ngModel]="node.data? node.data: node.default" [required]="node.use ==='required'"
                          class="form-control" id="{{node.name}}">
                    <option>true</option>
                    <option>false</option>
                  </select>
                  <select #localref6 (blur)="validateAttr(localref6.value, node)"
                          (change)="submitData(localref6.value, node)" *ngIf="node.values && node.values.length > 0"
                          [ngClass]="error && errorName === node.name? 'invalid': ''"
                          [ngModel]="node.data? node.data: node.default" [required]="node.use ==='required'"
                          class="form-control" id="{{node.name}}">
                    <option *ngFor="let value of node.values" [ngClass]="value.base ? 'hide':''">{{value.value}}</option>
                  </select>
                  <div *ngIf="error && errorName === node.name" [innerText]="text" class="col-4 text-danger"
                       id="{{node.name}}Alert" role="alert">
                  </div>
                </div>
              </div>
              <div *ngIf="selectedNode">
                <div *ngIf="selectedNode.values && selectedNode.values.length>0" class="text m-b-sm">Value<sup
                  *ngIf="!(selectedNode.values && selectedNode.values[0].use)" class="text-danger text-sm">*</sup></div>
                <div class="form-group">
                  <input #localref7 (blur)="validValue(localref7.value, selectedNode.ref, selectedNode.values[0])"
                         (change)="submitValue(localref7.value, selectedNode.ref, selectedNode.values[0])"
                         *ngIf="selectedNode && selectedNode.values && selectedNode.values[0].base  && selectedNode.values[0].base !== 'xs:boolean'  && selectedNode.values[0].parent === selectedNode.ref && selectedNode.ref !== 'Message' && selectedNode.ref !== 'Body' && selectedNode.ref !== 'Password' && selectedNode.ref !== 'CSPassword'"
                         [ngClass]="error? 'invalid': ''"
                         class="form-control" id="{{selectedNode.ref}}" placeholder="Example input"
                         type="text" value="{{selectedNode.values[0].data? selectedNode.values[0].data:''}}">

                  <input #localref7 (blur)="validValue(localref7.value, selectedNode.ref, selectedNode.values[0])"
                         (change)="submitValue(localref7.value, selectedNode.ref, selectedNode.values[0])"
                         *ngIf="selectedNode && selectedNode.values && selectedNode.values[0].base && selectedNode.values[0].base !== 'xs:boolean' && selectedNode.values[0].parent === selectedNode.ref && selectedNode.ref !== 'Message' && selectedNode.ref !== 'Body' && (selectedNode.ref === 'Password' || selectedNode.ref === 'CSPassword')"
                         [ngClass]="error? 'invalid': ''"
                         class="form-control" id="{{selectedNode.ref}}" placeholder="Example input"
                         type="password" value="{{selectedNode.values[0].data? selectedNode.values[0].data:''}}">

                  <div *ngIf="selectedNode.ref === 'Body'" [ngClass]="{ 'has-error': myckeditor.invalid && myckeditor.touched }"
                       class="form-group has-feedback">
                    <ckeditor #myckeditor="ngModel" (change)="onChange($event, selectedNode)" [(ngModel)]="myContent"
                              [config]="ckeConfig"
                              [ngClass]="error? 'invalid': ''" debounce="500" name="myckeditor"></ckeditor>
                    <div *ngIf="myckeditor.invalid && myckeditor.touched" class="help-block">Required field.</div>
                  </div>
                  <select #localref7 (blur)="validValue(localref7.value, selectedNode.ref, selectedNode.values[0])"
                          (change)="submitValue(localref7.value, selectedNode.ref, selectedNode.values[0])"
                          *ngIf="selectedNode && selectedNode.values && selectedNode.values[0].base === 'xs:boolean'"
                          [ngClass]="error? 'invalid': ''" class="form-control" id="{{selectedNode.ref}}"
                          value="{{selectedNode.values[0].data? selectedNode.values[0].data:''}}">
                    <option>true</option>
                    <option>false</option>
                  </select>
                  <textarea #localref8 (blur)="validValue(localref8.value, selectedNode.ref, selectedNode.values[0])"
                            (change)="submitValue(localref8.value, selectedNode.ref, selectedNode.values[0])"
                            *ngIf="selectedNode.ref === 'Message'" [ngClass]="error? 'invalid': ''" class="form-control"
                            id="{{selectedNode.ref}}" rows="4"
                            value="{{selectedNode.values[0].data? selectedNode.values[0].data:''}}"></textarea>
                  <div *ngIf="error && errorName === nodes.ref" [innerText]="text" class="mt-2 col-4 text-danger pl-0"
                       id="{{nodes.ref}}Alert"
                       role="alert">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="spinner" *ngIf="isLoading">
  <div></div>
</div>
